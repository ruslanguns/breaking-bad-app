{"version":3,"file":"static/js/145.936af0d4.chunk.js","mappings":"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","sources":["components/Loading.js","components/PageTitle.js","configs/chartjs.js","components/BarChart.js","components/Button.js","graphql/operations/mutation.js","graphql/operations/query.js","graphql/operations/subscription.js","helpers/navigate.js","pages/Details.js","../node_modules/@apollo/src/react/hooks/useMutation.ts","../node_modules/@apollo/src/react/hooks/useSubscription.ts"],"sourcesContent":["import { Ring } from \"react-awesome-spinners\";\n\nconst Loading = () => (\n  <span className=\"loading\">\n    <Ring size={454} />\n  </span>\n);\n\nexport default Loading;\n","const PageTitle = ({ title }) => (\n  <>\n    <h2>{title}</h2>\n    <hr />\n  </>\n);\n\nexport default PageTitle;\n","import {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    BarElement,\n    Title,\n    Tooltip,\n    Legend,\n  } from \"chart.js\";\n  \n  ChartJS.register(\n    CategoryScale,\n    LinearScale,\n    BarElement,\n    Title,\n    Tooltip,\n    Legend\n  );\n\n  export default ChartJS;","import { Bar } from \"react-chartjs-2\";\n// Configuración de los elemmentos como tooltip. labels,...que usaremos en las gráficas\n// eslint-disable-next-line no-unused-vars\nimport ChartJS from \"./../configs/chartjs\";\n\nconst BarChart = ({ titleChart, labels, dataValues }) => {\n  const options = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: \"top\",\n      },\n      title: {\n        display: true,\n        text: titleChart,\n      },\n    },\n  };\n\n  const data = {\n    labels,\n    datasets: [\n      {\n        label: \"Characters\",\n        data: dataValues,\n        backgroundColor: \"rgba(13, 202, 240, 1)\",\n      },\n    ],\n  };\n  return <Bar options={options} data={data} />;\n};\n\nexport default BarChart;\n","import \"./../styles/components.css\";\nimport PropTypes from \"prop-types\";\n\nconst Button = ({ label, param, action }) => {\n  return (\n    <>\n      <button className=\"btn btn-info btn-lg btn-block custom-button\"\n        onClick={() => action(param)}>\n        {label}\n      </button>\n    </>\n  );\n};\n\n// Para obligar pasar el argumento para el objeto\nButton.propTypes = {\n  label: PropTypes.string.isRequired,\n};\n\nexport default Button;\n","import { gql } from \"@apollo/client\";\n\nexport const ADD_VOTE = gql`\n  mutation Mutation($character: ID!) {\n    addVote(character: $character) {\n      status\n      message\n    }\n  }\n`;\n","import { gql } from \"@apollo/client\";\n\nexport const PRINCIPAL_CHARACTERS_VOTES = gql`\n  query PrincipalCharsVotes {\n    characters {\n      id\n      name\n      description\n      portrayed: actor\n      total_episodes\n      votes\n      url\n      img: photo\n    }\n  }\n`;\n\nexport const GET_CHARACTER = gql`\n  query detailsCharacter($id: ID!){\n    character(id: $id) {\n      id\n      total_episodes\n      votes\n      name\n      actor\n      description\n      photo\n      url\n    }\n  }\n`;\n","import { gql } from \"@apollo/client\";\n\nexport const CHANGE_VOTES_LISTENER = gql`\n  subscription {\n    changeVotes {\n      id\n      name\n      votes\n    }\n  }\n`;\n\n\nexport const CHANGE_VOTE_LISTENER = gql`\n    subscription characterVoteCount($id: ID!) {\n        changeVote(id: $id) {\n            id\n            name\n            votes\n        }\n    }\n`;","/**\n * Use to navigate to selec page and params\n * Reference cheatsheet\n * https://www.samanthaming.com/tidbits/86-window-location-cheatsheet/\n * @param {*} path \n * @param {*} params \n */\n export const navigateTo = (path, params) => {\n     if (params) {\n        window.location.href = window.location.origin.concat(`/breaking-bad-app/${path}/${params}`);\n        return;\n     }\n     window.location.href = window.location.origin.concat(`/breaking-bad-app/${path}`);\n   \n  };\n\nexport const openExternalURL = (url) => window.open(url, '_blank');","import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { useQuery, useMutation, useSubscription } from \"@apollo/client\";\nimport { GET_CHARACTER } from \"../graphql/operations/query\";\nimport { ADD_VOTE } from \"../graphql/operations/mutation\";\nimport { CHANGE_VOTE_LISTENER } from \"../graphql/operations/subscription\";\nimport { Loading, PageTitle, Button } from \"../components\";\nimport { openExternalURL } from \"../helpers/navigate\";\nconst Details = () => {\n  const { t } = useTranslation();\n  const [idProduct] = useState(useParams().id);\n  const [character, setCharacter] = useState({});\n  const { loading, error, data } = useQuery(GET_CHARACTER, {\n    variables: {\n      id: idProduct,\n    },\n  });\n  const [addVote] = useMutation(ADD_VOTE, {\n    update: (__, mutationResult) => {\n      console.log(mutationResult.data);\n    },\n  });\n  useSubscription(CHANGE_VOTE_LISTENER, {\n    variables: {\n      id: idProduct,\n    },\n  });\n\n  useEffect(() => {\n    if (data) {\n      setCharacter(data.character);\n    }\n  }, [data]);\n\n  const voteCharacter = (characterId) =>\n    addVote({\n      variables: {\n        character: characterId,\n      },\n    });\n\n  const goToMoreDetails = (url) => openExternalURL(url);\n\n  if (loading) return <Loading />;\n  if (error) return <p>Error :(</p>;\n  return (\n    <>\n      {character && (\n        <>\n          <PageTitle title={character.name} />\n          <div className=\"row\">\n            <div className=\"col-md-5\">\n              <img\n                className=\"img-fluid\"\n                src={character.photo}\n                alt={`${character.name} profile`}\n              />\n            </div>\n            <div className=\"col-lg\">\n              <h5 className=\"my-3\">{character.votes} {t(\"pages.details.votes\")}</h5>\n              <p>{character.description}</p>\n              <Button\n                key={character.id}\n                label={`${t(\"pages.details.vote_lbl\")} ${character.name}`}\n                param={character.id}\n                action={voteCharacter}\n              />\n              &nbsp;\n              <Button\n                key={`Wiki_${character.id}`}\n                label={t(\"pages.details.more_info\")}\n                param={character.url}\n                action={goToMoreDetails}\n              />\n            </div>\n          </div>\n        </>\n      )}\n    </>\n  );\n};\nexport default Details;","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { DocumentNode } from 'graphql';\nimport { TypedDocumentNode } from '@graphql-typed-document-node/core';\nimport {\n  MutationFunctionOptions,\n  MutationHookOptions,\n  MutationResult,\n  MutationTuple,\n} from '../types/types';\n\nimport {\n  ApolloCache,\n  DefaultContext,\n  mergeOptions,\n  OperationVariables,\n} from '../../core';\nimport { equal } from '@wry/equality';\nimport { DocumentType, verifyDocumentType } from '../parser';\nimport { ApolloError } from '../../errors';\nimport { useApolloClient } from './useApolloClient';\n\nexport function useMutation<\n  TData = any,\n  TVariables = OperationVariables,\n  TContext = DefaultContext,\n  TCache extends ApolloCache<any> = ApolloCache<any>,\n>(\n  mutation: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: MutationHookOptions<TData, TVariables, TContext>,\n): MutationTuple<TData, TVariables, TContext, TCache> {\n  const client = useApolloClient(options?.client);\n  verifyDocumentType(mutation, DocumentType.Mutation);\n  const [result, setResult] = useState<Omit<MutationResult, 'reset'>>({\n    called: false,\n    loading: false,\n    client,\n  });\n\n  const ref = useRef({\n    result,\n    mutationId: 0,\n    isMounted: true,\n    client,\n    mutation,\n    options,\n  });\n\n  // TODO: Trying to assign these in a useEffect or useLayoutEffect breaks\n  // higher-order components.\n  {\n    Object.assign(ref.current, { client, options, mutation });\n  }\n\n  const execute = useCallback((\n    executeOptions: MutationFunctionOptions<\n      TData,\n      TVariables,\n      TContext,\n      TCache\n    > = {}\n  ) => {\n    const {client, options, mutation} = ref.current;\n    const baseOptions = { ...options, mutation };\n    if (!ref.current.result.loading && !baseOptions.ignoreResults) {\n      setResult(ref.current.result = {\n        loading: true,\n        error: void 0,\n        data: void 0,\n        called: true,\n        client,\n      });\n    }\n\n    const mutationId = ++ref.current.mutationId;\n    const clientOptions = mergeOptions(\n      baseOptions,\n      executeOptions as any,\n    );\n\n    return client.mutate(clientOptions).then((response) => {\n      const { data, errors } = response;\n      const error =\n        errors && errors.length > 0\n          ? new ApolloError({ graphQLErrors: errors })\n          : void 0;\n\n      if (\n        mutationId === ref.current.mutationId &&\n        !clientOptions.ignoreResults\n      ) {\n        const result = {\n          called: true,\n          loading: false,\n          data,\n          error,\n          client,\n        };\n\n        if (ref.current.isMounted && !equal(ref.current.result, result)) {\n          setResult(ref.current.result = result);\n        }\n      }\n\n      baseOptions.onCompleted?.(response.data!);\n      executeOptions.onCompleted?.(response.data!);\n      return response;\n    }).catch((error) => {\n      if (\n        mutationId === ref.current.mutationId &&\n        ref.current.isMounted\n      ) {\n        const result = {\n          loading: false,\n          error,\n          data: void 0,\n          called: true,\n          client,\n        };\n\n        if (!equal(ref.current.result, result)) {\n          setResult(ref.current.result = result);\n        }\n      }\n\n      if (baseOptions.onError || clientOptions.onError) {\n        baseOptions.onError?.(error);\n        executeOptions.onError?.(error);\n        // TODO(brian): why are we returning this here???\n        return { data: void 0, errors: error };\n      }\n\n      throw error;\n    });\n  }, []);\n\n  const reset = useCallback(() => {\n    setResult({ called: false, loading: false, client });\n  }, []);\n\n  useEffect(() => () => {\n    ref.current.isMounted = false;\n  }, []);\n\n  return [execute, { reset, ...result }];\n}\n","import '../../utilities/globals';\nimport { useState, useRef, useEffect } from 'react';\nimport { DocumentNode } from 'graphql';\nimport { TypedDocumentNode } from '@graphql-typed-document-node/core';\nimport { equal } from '@wry/equality';\n\nimport { DocumentType, verifyDocumentType } from '../parser';\nimport {\n  SubscriptionHookOptions,\n  SubscriptionResult\n} from '../types/types';\nimport { OperationVariables } from '../../core';\nimport { useApolloClient } from './useApolloClient';\n\nexport function useSubscription<TData = any, TVariables = OperationVariables>(\n  subscription: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: SubscriptionHookOptions<TData, TVariables>,\n) {\n  const client = useApolloClient(options?.client);\n  verifyDocumentType(subscription, DocumentType.Subscription);\n  const [result, setResult] = useState<SubscriptionResult<TData>>({\n    loading: !options?.skip,\n    error: void 0,\n    data: void 0,\n    variables: options?.variables,\n  });\n\n  const [observable, setObservable] = useState(() => {\n    if (options?.skip) {\n      return null;\n    }\n\n    return client.subscribe({\n      query: subscription,\n      variables: options?.variables,\n      fetchPolicy: options?.fetchPolicy,\n      context: options?.context,\n    });\n  });\n\n  const ref = useRef({ client, subscription, options });\n  useEffect(() => {\n    let shouldResubscribe = options?.shouldResubscribe;\n    if (typeof shouldResubscribe === 'function') {\n      shouldResubscribe = !!shouldResubscribe(options!);\n    }\n\n    if (options?.skip && !options?.skip !== !ref.current.options?.skip) {\n      setResult({\n        loading: false,\n        data: void 0,\n        error: void 0,\n        variables: options?.variables,\n      });\n      setObservable(null);\n    } else if (\n      shouldResubscribe !== false && (\n        client !== ref.current.client ||\n        subscription !== ref.current.subscription ||\n        options?.fetchPolicy !== ref.current.options?.fetchPolicy ||\n        !options?.skip !== !ref.current.options?.skip ||\n        !equal(options?.variables, ref.current.options?.variables)\n      )\n    ) {\n      setResult({\n        loading: true,\n        data: void 0,\n        error: void 0,\n        variables: options?.variables,\n      });\n      setObservable(client.subscribe({\n        query: subscription,\n        variables: options?.variables,\n        fetchPolicy: options?.fetchPolicy,\n        context: options?.context,\n      }));\n    }\n\n    Object.assign(ref.current, { client, subscription, options });\n  }, [client, subscription, options]);\n\n  useEffect(() => {\n    if (!observable) {\n      return;\n    }\n\n    const subscription = observable.subscribe({\n      next(fetchResult) {\n        const result = {\n          loading: false,\n          // TODO: fetchResult.data can be null but SubscriptionResult.data\n          // expects TData | undefined only\n          data: fetchResult.data!,\n          error: void 0,\n          variables: options?.variables,\n        };\n        setResult(result);\n\n        ref.current.options?.onSubscriptionData?.({\n          client,\n          subscriptionData: result\n        });\n      },\n      error(error) {\n        setResult({\n          loading: false,\n          data: void 0,\n          error,\n          variables: options?.variables,\n        });\n      },\n      complete() {\n        ref.current.options?.onSubscriptionComplete?.();\n      },\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [observable]);\n\n  return result;\n}\n"],"names":["className","size","title","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","options","responsive","plugins","legend","position","display","text","titleChart","data","labels","datasets","label","dataValues","backgroundColor","param","action","onClick","ADD_VOTE","gql","PRINCIPAL_CHARACTERS_VOTES","GET_CHARACTER","CHANGE_VOTES_LISTENER","CHANGE_VOTE_LISTENER","openExternalURL","url","window","open","t","useTranslation","useState","useParams","id","idProduct","character","setCharacter","useQuery","variables","loading","error","useMutation","update","__","mutationResult","console","log","addVote","useSubscription","useEffect","name","src","photo","alt","votes","description","characterId","mutation","client","called","result","setResult","ref","useRef","mutationId","isMounted","Object","assign","current","execute","useCallback","executeOptions","baseOptions","ignoreResults","clientOptions","mutate","then","response","errors","length","graphQLErrors","onCompleted","catch","onError","reset","subscription","skip","subscribe","query","fetchPolicy","context","observable","setObservable","shouldResubscribe","next","fetchResult","onSubscriptionData","subscriptionData","complete","onSubscriptionComplete","unsubscribe"],"sourceRoot":""}